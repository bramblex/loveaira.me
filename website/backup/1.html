<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<base href="http://lovearia.me/article/show/1"><style type="text/css">body { margin-left:0;margin-right:0;margin-top:0; }#google-cache-hdr {background:#f5f5f5 !important;font:13px arial,sans-serif !important;text-align:left !important;color:#202020 !important;border:0 !important;margin:0 !important;border-bottom:1px solid #cecece !important;line-height:16px !important ;padding:16px 28px 24px 28px !important;}#google-cache-hdr * {display:inline !important;font:inherit !important;text-align:inherit !important;color:inherit !important;line-height:inherit !important;background:none !important;border:0 !important;margin:0 !important;padding:0 !important;letter-spacing:0 !important;}#google-cache-hdr a {text-decoration:none !important;color:#1a0dab !important;}#google-cache-hdr a:hover { text-decoration:underline !important; }#google-cache-hdr a:visited { color:#609 !important; }#google-cache-hdr div { display:block !important;margin-top:4px !important; }#google-cache-hdr b {font-weight:bold !important;display:inline-block !important;direction:ltr !important;}</style><div id="google-cache-hdr"  dir=ltr><div>This is Google&#39;s cache of <a href="http://lovearia.me/article/show/1" dir="ltr">http://lovearia.me/article/show/1</a>. It is a snapshot of the page as it appeared on Aug 9, 2016 23:05:13 GMT. </div><div>The <a href="http://lovearia.me/article/show/1" dir="ltr">current page</a> could have changed in the meantime. <a href="http://support.google.com/websearch/bin/answer.py?hl=en&amp;p=cached&amp;answer=1687222">Learn more</a></div><div></div><div><span style="display:inline-block !important;margin-top:8px !important;margin-right:104px !important;white-space:nowrap !important;"><span style="margin-right:28px !important;"><span style="font-weight:bold !important;">Full version</span></span><span style="margin-right:28px !important;"><a href="http://webcache.googleusercontent.com/search?q=cache:lovearia.me/article/show/1&amp;num=1&amp;ie=UTF-8&amp;prmd=ivns&strip=1&vwsrc=0">Text-only version</a></span><span style="margin-right:28px !important;"><a href="http://webcache.googleusercontent.com/search?q=cache:lovearia.me/article/show/1&amp;num=1&amp;ie=UTF-8&amp;prmd=ivns&strip=0&vwsrc=1">View source</a></span></span><span style="display:inline-block !important;margin-top:8px !important;color:#717171 !important;">Tip: To quickly find your search term on this page, press <b>Ctrl+F</b> or <b>⌘-F</b> (Mac) and use the find bar.</span></div></div><div style="position:relative;">
<html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="description" content="Brambles' Blog."/><title>LoveAria.Me - 【瞎扯】谈谈为什么我喜欢JavaScript</title><link rel="shortcut icon" href="/favicon.ico"/><link rel="stylesheet" href="//cdn.jsdelivr.net/g/pure@0.6.0,github-markdown-css@2.2.1,highlight.js@9.2.0(styles/github.min.css)"/><link rel="stylesheet" href="/static/css/main.css"/><script src="//cdn.jsdelivr.net/jquery/2.2.1/jquery.min.js"></script><script src="/static/js/main.js"></script></head><body><div id="layout"><a href="javascript:void(0);" id="menuLink" class="menu-link"><span></span></a><div id="menu"><div class="pure-menu"><a class="pure-menu-heading">LOVEARIA.ME</a><ul class="pure-menu-list"><li class="pure-menu-item"><a class="pure-menu-link" href="/">首页</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/#作者">作者</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/#联系">联系</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/article">文章</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/category">分类</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="https://github.com/bramblex">Github</a></li><li class="pure-menu-item menu-item-divided"><a class="pure-menu-link" href="/user/login">登录</a></li></ul></div></div><div id="main"><div class="header"><h1>【瞎扯】谈谈为什么我喜欢JavaScript</h1><h2></h2></div><div class="content"><div class="pure-u-1 article-toolbar"><div class="article-category">分类： <a href="/article/category/0">根分类</a> > <a href="/article/category/1">技术杂谈</a></div></div><div class="article markdown-body"><h2>目录</h2><ul><li><a href="#JavaScript-有哪些地方被喷-">JavaScript 有哪些地方被喷？</a></li><ul><li><a href="#Callback">Callback</a></li><li><a href="#异步">异步</a></li><ul><li><a href="#反直觉">反直觉</a></li><li><a href="#Callback-Hell">Callback Hell</a></li></ul></ul><li><a href="#为什么我喜欢-JavaScript-">为什么我喜欢 JavaScript ？</a></li><ul><li><a href="#JavaScript-该有的都有了-虽然都堪堪可用">JavaScript 该有的都有了, 虽然都堪堪可用</a></li><li><a href="#JavaScript-在目前主流语言中拥有最顺手的函数式特性">JavaScript 在目前主流语言中拥有最顺手的函数式特性</a></li><li><a href="#哪里都能跑">哪里都能跑</a></li><li><a href="#其他">其他</a></li></ul><li><a href="#总结">总结</a></li></ul></ul><h2><a name="JavaScript-有哪些地方被喷-" class="anchor" href="#JavaScript-有哪些地方被喷-"><span class="header-link">▶</span></a>JavaScript 有哪些地方被喷？</h2><p>javaScript 是一门被喷得非常之多的语言，然而大部分人都只不过是跟风喷。限于这些喷子的水平不足，他们并不能说出个靠谱的喷点来。被这些跟风喷子喷的最多的就是 Callback和异步 这个问题。接下来分别来讲讲这两个问题。</p>
<h3><a name="Callback" class="anchor" href="#Callback"><span class="header-link">▶</span></a>Callback</h3><p>其实在那些喷子眼里，Callback 和 异步是同一个问题，因为他们眼里没有<strong>高阶函数</strong>这个概念。他们觉得只要把函数当成参数传入另一个函数，就是异步。这种想法显然是错误的。所以本小节的主题应该是<strong>高阶函数</strong>，而不是Callback。</p>
<p>什么是高阶函数（Higher-order function）？从定义上来讲，高阶函数是一种函数，它接受一个函数作为参数并且返回另一个函数。举个例子：</p>
<pre><code class="lang-JavaScript"><span class="hljs-keyword">var</span> double = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>)</span>{ <span class="hljs-comment">// 接受一个函数做参数</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>)</span>{ <span class="hljs-comment">// 返回另一个函数</span>
        <span class="hljs-keyword">return</span>  f(x) * <span class="hljs-number">2</span>; <span class="hljs-comment">// 函数的结果 *2</span>
    };
};

<span class="hljs-keyword">var</span> f = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>)</span>{
    <span class="hljs-keyword">return</span> x + <span class="hljs-number">2</span>;
};

<span class="hljs-keyword">var</span> g =  double(f); <span class="hljs-comment">// 把 f 作为参数传入 double 并返回新函数 g</span>

<span class="hljs-built_in">console</span>.log(g(<span class="hljs-number">1</span>)); <span class="hljs-comment">// =&gt; 输出 6</span>
</code></pre>
<p>例子举完了了，有一点计算机基础的应该都能看得懂，高阶函数就干了这点破事而已。但是问题还没结束，看到这里如果对函数编程不了解的同学可能就要问了： <em>你说的我都懂啊，但是你举的这个例子有什么卵用呢？真写代码的时候谁会真么写啊？</em></p>
<p>有这样的疑问一点都不奇怪，以为上面那个例子只是告诉你高阶函数是啥，并没有告诉你高阶函数有卵用。高阶函数的卵用有且仅有一点——过程抽象。不过很多编程书都告诉你写代码中<strong>抽象</strong>很重要吗？现在看到高大上的<strong>抽象</strong>两个字有没有觉得很激动啊？接下来我用最最最简单的例子 map 来讲。</p>
<pre><code class="lang-JavaScript"><span class="hljs-keyword">var</span> l = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>];
<span class="hljs-keyword">var</span> double_l = l.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>)</span>{<span class="hljs-keyword">return</span> i*<span class="hljs-number">2</span>;});
<span class="hljs-built_in">console</span>.log(double_l); <span class="hljs-comment">// =&gt; 输出 [2,4,6,8,10,12,14]</span>
</code></pre>
<p>嗯……讲完了。map 就是那么简单的东西。接受一个函数，然后应用到数组的每一项上，最后返回一个新数组。所以map是啥？通俗地讲，map 是一个抽象过程。map 会对一个数组上的每一项做一样事，并把做完这样事后产生的结果组成一个新的数组，具体做什么会返回什么样的结果，则由你传入的函数决定。</p>
<p>所以说了那么多，高阶函数就是一种对过程的抽象。而 Callback 不过就是给一个高阶函数穿进去的参数而已。</p>
<h3><a name="异步" class="anchor" href="#异步"><span class="header-link">▶</span></a>异步</h3><p>喷JavaScript的另一点在异步上，而且喷点多在：反直觉和Callback Hell</p>
<h4><a name="反直觉" class="anchor" href="#反直觉"><span class="header-link">▶</span></a>反直觉</h4><p>首先喷反直觉的我就不想说什么，这说明计算机理论知识堪忧啊，操作系统课没上过吗？我们现在的多任务操作系统是怎么来的？给你们补一补计算机历史内容吧。</p>
<p>原来我们的操作系统还是单任务，一次只能运行一个程序的时候。一个勇敢的骚年突发奇想，在电脑上写了两个程序。A程序不断地输出A字符，B程序不断地输出B字符。这个勇敢的骚年写了一个调度程序，用来调度切换AB两程序。最后此骚年惊喜看到了电脑屏幕上A和B交叉着输出，于是我们现在的多任务操作系统雏形就产生了。</p>
<p>我来问问，当我们的CPU还是单核单线程的时候，怎么切换两个程序啊？我来自问自答：对CPU发出中断，然后利用中断处理程序来切换正在运行的程序。哎？你听着有没有点耳熟啊？对CPU发送的中断，这不跟 JavaScript 里面事件很像啊？中断处理程序有没有像 JavaScript 里面传入的 Callback 啊？</p>
<p>所以啊，我说你们都 too naive。别整天瞎跟着那些瞎忽悠的“技术前沿”转悠，先把老祖宗们留下的精粹吃透了。学习老祖宗们留下来的基本方法和基本思想还是很有指导意义的，以后上手那些整天瞎逼逼吹牛的新技术也会很轻松的。</p>
<p>处理并行有两个非常经典的模型：多线程模型 和 事件驱动模型。说起异步，我们自然而然地对号入座，明确我们要讨论的是<strong>事件驱动模型</strong>。JavaScript 为什么要选用 事件驱动模型 来作为它的异步处理方案呢？这个问题的答案是非常明显的，JavaScript 生出来是为了给浏览器做交互用的，而 事件驱动模型 跟 UI 是最合得来的。其实 JavaScript 在处理页面 UI 交互方面是最符合直觉的，有人觉得反直觉我就没懂了。</p>
<h4><a name="Callback-Hell" class="anchor" href="#Callback-Hell"><span class="header-link">▶</span></a>Callback Hell</h4><p>这是一个不是槽点的槽点。Callback Hell 的问题不在 JavaScript 这门语言上面，而在于使用者本身。JavaScript 这种函数定义就是表达式的特点比那些单行 Lambda 高到不知道哪里去了。然而由于使用者的滥用，导致 JavaScript Callback Hell 这个槽点的产生。异步问题其实就是一个 Continuation 的问题，而现在的类似 Promise 这种东西，也不过就是一个 Continuation Monad 而已。我都不觉得有什么好说的了，贴一段 <a href="http://lovearia.me">本博客程序 LoveAria.Me</a> 处理异步的代码给你们看看，虽然是 PureScript ，但是本质上还是编译到 JavaScript 执行的，你们看看哪里来的 Callback Hell？</p>
<pre><code class="lang-Haskell"><span class="hljs-title">getCategoryTree</span> :: <span class="hljs-keyword">forall</span> eff. <span class="hljs-type">Int</span> -&gt; <span class="hljs-type">ModelAff</span> eff <span class="hljs-type">CategoryTree</span> <span class="hljs-comment">-- 这是一个异步函数，返回一个 CategoryTree 类型</span>
<span class="hljs-title">getCategoryTree</span> id = <span class="hljs-keyword">do</span>
  category &lt;- findCategoryById id <span class="hljs-comment">-- 这里是异步查询数据库</span>
  children &lt;- findallCategory (<span class="hljs-string">"parent_id"</span> .== category.id .&amp;&amp; <span class="hljs-string">"id"</span> .!= <span class="hljs-number">0</span>) (<span class="hljs-type">Desc</span> <span class="hljs-string">"id"</span>) <span class="hljs-comment">-- 这里是也是异步查询数据库</span>
  children_tree &lt;- sequence $ map (\c -&gt; getCategoryTree c.id) $ children <span class="hljs-comment">-- 这里是异步并且还递归查询数据库，getCategoryTree 就是本函数</span>
  return $ <span class="hljs-type">CategoryTree</span> category children_tree <span class="hljs-comment">-- 这里是返回 CategoryTree</span>
</code></pre>
<h2><a name="为什么我喜欢-JavaScript-" class="anchor" href="#为什么我喜欢-JavaScript-"><span class="header-link">▶</span></a>为什么我喜欢 JavaScript ？</h2><p>好了，前面扯了那么多蛋了，现在回到正题，为啥我喜欢 JavaScript？</p>
<h3><a name="JavaScript-该有的都有了-虽然都堪堪可用" class="anchor" href="#JavaScript-该有的都有了-虽然都堪堪可用"><span class="header-link">▶</span></a>JavaScript 该有的都有了, 虽然都堪堪可用</h3><blockquote>
<p>JavaScript是一种基于原型的、多范式的动态脚本语言，并且支持面向对象、命令式编程风格和函数式编程风格。——摘自MDN</p>
</blockquote>
<p>JavaScript设计上虽然有很多缺陷和不完善，但毫无疑问的是，JavaScript该有的都有了（真的是大杂烩），虽然每样都只是堪堪够用。在语言层面上，JavaScript 覆盖了面对对象、函数式、命令式多个编程语言范式。所以JavaScript也可以非常轻易的作为非常多其他语言所翻译的目标语言，无论是命令式、面对对象或者是函数式语言，都能非常轻松得翻译成JavaScript进行执行。放在其他语言身上，那可能就需要拖着沉重的 Runtime 了。</p>
<h3><a name="JavaScript-在目前主流语言中拥有最顺手的函数式特性" class="anchor" href="#JavaScript-在目前主流语言中拥有最顺手的函数式特性"><span class="header-link">▶</span></a>JavaScript 在目前主流语言中拥有最顺手的函数式特性</h3><p>毕竟JavaScript是first-class-functions，而且函数本身也是表达式，所以可以非常轻松愉快得把函数放到任何地方使用。而且，JavaScript 是一门面对对象的语言。在 JavaScript 中，函数也是对象，可以像对象一样操作和传递，甚至还可以用函数对象存储变量。用函数存储变量应该算是一个在 JavaScript 中很 Hack 的技巧了吧 ╮(╯▽╰)╭</p>
<p>就目前来看，我觉得JavaScript的函数式特性是目前主流编程语言中让我用得最顺手的，没有之一。其他非主流语言我就不说了。因为譬如<a href="http://lovearia.me">本博客程序 LoveAria.Me</a> 所使用的 PureScript 是纯函数式语言，当然跟 JavaScript 这种业余的不可同日而语。不过 PureScript 实在是太小众了，小众得没朋友了都。</p>
<p>前我见到有人提问，为什么JavaScript中没有lambda表达式。我倒是觉得JavaScript中根本不需要lambda表达式，因为JavaScript中的函数本身就是表达式，比其他很多语言中蹩脚的lambda表达式好用不知道多少。</p>
<p>其他动态语言，诸如 Python / Ruby 等虽然有部分函数式特性，但是用起来都不是很顺手。除了 Python 的装饰器写起来还算赏心悦目。</p>
<h3><a name="哪里都能跑" class="anchor" href="#哪里都能跑"><span class="header-link">▶</span></a>哪里都能跑</h3><p>目前为止，JavaScript应该是最接近Java所提出的目标的——一处编写，到处运行。JavaScript可以运行在非常多得平台上包括不限于浏览器、服务器、桌面、移动终端甚至是嵌入式设备上。而且核心不涉及调用宿主API的部分可以轻松分离封装可以不用修改一行代码而直接运行在任何JavaScript环境下的模块。</p>
<p>我自己还给自己封装了一个工具，用来模块化 JavaScript 。让模块不改一行代码就可以用 script 标签、CMD、AMD 以及 node 上的 CommonJS 加载执行。</p>
<h3><a name="其他" class="anchor" href="#其他"><span class="header-link">▶</span></a>其他</h3><p>以npm为核心的生态环境是JavaScript的另一个亮点，上面包括了各种种类繁多的各种库，虽然有部分质量堪忧，但是光是“有”就已经超越非常多其他语言了。很多语言还是没有靠谱的包管理，和生态环境呢，还需要靠着大量的复制粘贴来活着。</p>
<p>元编程是动态语言的一大利器，JavaScript作为一门动态语言，也能靠元编程来进行一些意想不到的Hack。当然啦，元编程作为一门黑魔法，遭到过很多人的抵制并且说什么性能差啊、不可控啊、安全隐患啊……但是我觉得使用和滥用是两码事，并且自由也必然会带来这些副作用。</p>
<h2><a name="总结" class="anchor" href="#总结"><span class="header-link">▶</span></a>总结</h2><p>如果让我给 JavaScript 打分，我估计每项都只能给他 60 分，但他是个不偏科的好孩子啊，只是不像其他语言优点那么明显而已（除了可以跑在浏览器上这一点，我真找不出他有啥明显优势）。JavaScript 该有的都有了，虽然只是堪堪可用。而他的优点就是，啥都有，做啥都行，虽然都不一定做的很好。</p>
<p>哎？怎么感觉我整篇文章都是在黑 JavaScript 的啊？逃~</p>
</div><div class="article-date"><small>2016-03-08 12:06:29 | 2016-02-26 07:09:28</small></div><div class="pure-u-1 comments"><div class="pure-g"><div class="pure-u-1" id="disqus_thread"></div><script>var disqus_config = function () {this.page.identifier = "article_1"; this.page.title = document.title; this.page.url = location.href;}; (function() { var d = document, s = d.createElement('script'); s.src = '//lovearia.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s);})();</script></div></div></div><div class="footer"></div></div></div></body></html>